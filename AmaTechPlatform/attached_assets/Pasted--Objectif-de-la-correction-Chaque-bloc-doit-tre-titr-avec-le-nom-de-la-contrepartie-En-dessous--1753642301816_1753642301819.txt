‚úÖ Objectif de la correction
Chaque bloc doit √™tre titr√© avec le nom de la contrepartie

En-dessous, une liste chronologique des √©v√©nements de la semaine, bien format√©e

Supprimer le bloc undefined qui vient du nom manquant ou mal r√©cup√©r√©

üß† √âtapes √† corriger c√¥t√© frontend
1. Corriger le regroupement par counterparty_name
‚ùå Actuel (probl√©matique) :
Tu fais s√ªrement un grouped[event.name], or event.name est mal nomm√© ou undefined

‚úÖ Correctif :
Dans le regroupement, utiliser un champ explicite r√©cup√©r√© depuis l‚ÄôAPI : counterpartyName
(Mets √† jour la requ√™te SQL si besoin pour renommer la colonne)

ts
Copier
Modifier
const grouped = useMemo(() => {
  const byCounterparty = {};
  data?.events?.forEach((e) => {
    const name = e.counterpartyName || "Contrepartie inconnue";
    if (!byCounterparty[name]) byCounterparty[name] = [];
    byCounterparty[name].push(formatEvent(e));
  });
  return byCounterparty;
}, [data]);
2. Renommer la colonne dans ton backend
Dans ton routeur Express, modifie ceci pour que le champ de jointure soit bien lisible :

ts
Copier
Modifier
const events = await db
  .select({
    counterpartyId: roadshow_event.counterparty_id,
    counterpartyName: roadshow_counterparty.name,
    type: roadshow_event.type,
    date: roadshow_event.date,
    meta: roadshow_event.meta,
  })
‚úÖ Le frontend pourra alors faire event.counterpartyName

3. (Optionnel) Trier les √©v√©nements par date croissante
Juste avant l‚Äôaffichage :

ts
Copier
Modifier
byCounterparty[name].sort((a, b) => new Date(a.date) - new Date(b.date));
4. Composant d‚Äôaffichage am√©lior√©
tsx
Copier
Modifier
return (
  <div className="space-y-6 mt-6">
    {Object.entries(grouped).map(([name, events]) => (
      <div key={name} className="border p-4 rounded bg-muted/10">
        <h3 className="text-sm font-semibold text-muted-foreground mb-2">
          {name} ‚Äî {events.length} √©v√©nement{events.length > 1 ? 's' : ''}
        </h3>
        <ul className="list-disc ml-6 text-sm space-y-1">
          {events.map((e, i) => (
            <li key={i}>{e}</li>
          ))}
        </ul>
      </div>
    ))}
  </div>
);
‚ú® R√©sultat attendu
Plus de undefined

Un bloc par contrepartie

Chaque bloc commence par un titre clair (ex : Tescc ‚Äî 6 √©v√©nements)

√âv√©nements tri√©s et affich√©s proprement

